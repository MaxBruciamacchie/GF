{
    "contents" : "#' Conversion des données brutes de la base GF en 2 archives RData.\n#' @description Import des classeurs Excel de chaque forêt et sauvegarde dans l'archive\n#' gfDonneesBrutes.Rdata.\n#'\n#' Import des différentes tables de codification et sauvegarde dans l'archive psdrfCodes.Rdata.\n#' @return La fonction exporte dans le dossier Tables l'archive suivante :\n#'\n#' gfDonneesBrutes.Rdata\n#'\n#' @author Bruciamacchie Max\n#' @param rep = répertoire contenant les données\n#' @import tcltk\n#' @import openxlsx\n#' @export\ngf_Xls2Rdata <- function(rep) {\n  old <- getwd()\n  file <- file.choose()\n  setwd(dirname(file))\n\n  # ---------------- Import\n  Forets            <- read.xlsx(file, sheet=\"Foret\")\n  Cycles            <- read.xlsx(file, sheet=\"Cycle\")\n  Echantillonnages  <- read.xlsx(file, sheet=\"Echantillonnage\")\n  Placettes         <- read.xlsx(file, sheet=\"Placette\")\n  Tiges             <- read.xlsx(file, sheet=\"Arbres\")\n  Tarifs            <- read.xlsx(file, sheet=\"Tarif\")\n  AccD              <- read.xlsx(file, sheet=\"AccD\")\n  Prix              <- read.xlsx(file, sheet=\"Prix\")\n  EssReg            <- read.xlsx(file, sheet=\"EssReg\")\n  EssInd            <- read.xlsx(file, sheet=\"EssInd\")\n  Tiers             <- read.xlsx(file, sheet=\"Tiers\")\n  Essences          <- read.xlsx(file, sheet=\"Essences\")\n  Quals             <- read.xlsx(file, sheet=\"Qual\")\n  CodeEcolos        <- read.xlsx(file, sheet=\"CodeEcolo\")\n  Reges             <- read.xlsx(file, sheet=\"Rege\")\n  PCQM              <- read.xlsx(file, sheet=\"PCQM\")\n  Cercles           <- read.xlsx(file, sheet=\"Cercle\")\n  BMSLineaires      <- read.xlsx(file, sheet=\"BMSLineaire\")\n  BMSCercles        <- read.xlsx(file, sheet=\"BMSCercle\")\n  Hauts             <- read.xlsx(file, sheet=\"Haut\")\n  Coords            <- read.xlsx(file, sheet=\"Coord\")\n  Reperes           <- read.xlsx(file, sheet=\"Reperes\")\n  # --------------- Réorganisation\n  Tiges$IdArbre     <- 1:dim(Tiges)[1]\n  IdArbres          <- subset(Tiges, select=c(dim(Tiges)[2],1:7))\n  ValArbres         <- subset(Tiges, select=c(dim(Tiges)[2],8:(dim(Tiges)[2]-1)))\n  # --------------- Corrections\n  if (dim(BMSLineaires)[1]>0) {BMSLineaires$Angle[which(is.na(BMSLineaires$Angle))] <- 0}\n  Placettes$Pente[which(is.na(Placettes$Pente))] <- 0\n  Placettes$CoeffPente <- 1/(1+Placettes$Pente^2)^0.25\n  t1 <- Reges[,6:11]\n  if (dim(t1)[1] >0) {t1[is.na(t1)] <- 0}\n  Reges <- cbind(Reges[,1:5],t1,Reges$Observation)\n  names(Reges)[12] <- \"Observation\"\n  # --------------- Sauvegarde\n  setwd(old)\n  dir.create(\"Tables\", showWarnings = F)\n  rm(Tiges, file)\n  save(Forets,Echantillonnages,Cycles,Placettes,Coords,PCQM,Cercles,Reges,\n                BMSLineaires,BMSCercles,Tarifs,Tiers,Hauts,AccD,Essences,EssReg,EssInd,\n                CodeEcolos,Quals,Prix,IdArbres,ValArbres,Reperes, \n                file = \"Tables/gfDonneesBrutes.Rdata\")\n}\n",
    "created" : 1416999928733.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2956565752",
    "id" : "84CE8CC5",
    "lastKnownWriteTime" : 1417003682,
    "path" : "~/Desktop/Packages/GF/PermGF/R/gf_Xls2Rdata.R",
    "project_path" : "PermGF/R/gf_Xls2Rdata.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}